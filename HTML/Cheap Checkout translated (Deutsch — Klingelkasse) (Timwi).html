<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>Klingelkasse — Keep Talking and Nobody Explodes-Modul</title>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <link rel="stylesheet" type="text/css" href="css/Modules/Cheap Checkout.css">
    <script src="js/ktane-utils.js"></script>
    <script src="js/ruleseed.js"></script>
    <script>
        let Prices = [
            // Original 34 items
            "Candy Canes,3.51,Süßigkeit",
            "Socks,6.97,Sonstige",
            "Lotion,7.97,Hygiene",
            "Cheese,4.49,Milchprodukt",
            "Mints,6.39,Süßigkeit",
            "Grape Jelly,2.98,Süßigkeit",
            "Honey,8.25,Süßigkeit",
            "Sugar,2.08,Süßigkeit",
            "Soda,2.05,Süßigkeit",
            "Tissues,3.94,Hygiene",
            "White Bread,2.43,Getreide",
            "Canola Oil,2.28,Öl",
            "Mustard,2.36,Sonstige",
            "Deodorant,3.97,Hygiene",
            "White Milk,3.62,Milchprodukt",
            "Pasta Sauce,2.30,Gemüse",
            "Lollipops,2.61,Süßigkeit",
            "Cookies,2.00,Süßigkeit",
            "Paper Towels,9.46,Hygiene",
            "Tea,2.35,Wasser",
            "Coffee Beans,7.85,Sonstige",
            "Mayonnaise,3.99,Öl",
            "Chocolate Milk,5.68,Milchprodukt",
            "Fruit Punch,2.08,Süßigkeit",
            "Potato Chips,3.25,Öl",
            "Shampoo,4.98,Hygiene",
            "Toothpaste,2.50,Hygiene",
            "Peanut Butter,5.00,Eiweiß",
            "Gum,1.12,Süßigkeit",
            "Water Bottles,9.37,Wasser",
            "Spaghetti,2.92,Getreide",
            "Chocolate Bar,2.10,Süßigkeit",
            "Ketchup,3.59,Sonstige",
            "Cereal,4.19,Getreide",

            // New rule seed items
            "Eggs,2.67,Eiweiß",
            "Baked Beans,1.14,Eiweiß",
            "Peanuts,5.98,Eiweiß",
            "Yogurt,2.72,Milchprodukt",
            "Greek Yogurt,3.47,Milchprodukt",
            "Butter,5.86,Milchprodukt",
            "Toothbrush,2.24,Hygiene",
            "Medicine,3.73,Hygiene",
            "Soup,1.99,Sonstige",
            "Soap,3.97,Hygiene",
            "Pretzels,2.98,Getreide",
            "Popcorn,2.50,Getreide",
            "Oatmeal,7.98,Getreide",
            "Rice,2.02,Getreide",
            "Flour,3.49,Getreide",
            "Licorice,1.98,Süßigkeit",
            "Pie,3.98,Süßigkeit",
            "Cake,9.98,Süßigkeit",
            "Gummy Bears,7.98,Süßigkeit",
            "Relish,2.74,Gemüse",
            "Napkins,1.09,Hygiene",
            "Band-Aids,1.11,Hygiene",
            "Playing Cards,2.13,Sonstige",
            "Beef Jerky,1.23,Sonstige",
            "Ice Cream,4.99,Milchprodukt",
            "Salad Mix,2.47,Gemüse",
            "Bagel,4.20,Getreide",
            "Vegetable Oil,2.89,Öl",
            "Batteries,4.49,Sonstige",
            "Taco Shells,5.01,Getreide",
            "Bleach,6.90,Sonstige",
            "Baking Soda,0.33,Sonstige",
            "Paper Bags,1.07,Sonstige",
            "Printer Paper,4.49,Sonstige",
            "Diapers,6.96,Hygiene",
            "Shower Gel,1.63,Hygiene",
            "Makeup Remover,1.02,Hygiene",
            "Blank DVDs,9.00,Sonstige",
            "Nail Polish,3.13,Hygiene",
            "Fusilli,2.92,Getreide",
            "Tagliatelle,2.92,Getreide",
            "Spirelli,2.92,Getreide",
            "Penne,2.92,Getreide",
            "Car Engine Oil,3.36,Öl",
            "Parsley,0.69,Gewürz",
            "Sage,1.75,Gewürz",
            "Rosemary,3.19,Gewürz",
            "Thyme,2.89,Gewürz",
            "White Pepper,2.49,Gewürz",
            "Coriander,0.99,Gewürz",
            "Oregano,1.59,Gewürz",
            "Cumin,3.45,Gewürz",
            "Masala,4.99,Gewürz",
            "Saffron,12.79,Gewürz",
            "Cinnamon,2.40,Gewürz",
            "Cayenne Pepper,11.27,Gewürz",
            "Ginger Root,1.00,Gewürz",
            "Salt,3.98,Gewürz",
            "Sesame,3.19,Gewürz",
            "Vanilla Extract,11.82,Gewürz",
            "Red Wine,20.90,Wasser",
            "White Wine,18.60,Wasser",
            "12-pack Beer,10.49,Wasser",
            "6-pack Beer,5.79,Wasser",
            "Vinegar,2.50,Sonstige",
        ];

        let PricesLB = [
            // Original 12 weight based items
            "Turkey,2.98,Eiweiß",
            "Chicken,1.99,Eiweiß",
            "Steak,4.97,Eiweiß",
            "Pork,4.14,Eiweiß",
            "Lettuce,1.10,Gemüse",
            "Potatoes,0.68,Gemüse",
            "Tomatoes,1.80,Frucht",
            "Broccoli,1.39,Gemüse",
            "Oranges,0.80,Frucht",
            "Lemons,1.74,Frucht",
            "Bananas,0.87,Frucht",
            "Grapefruit,1.08,Frucht",

            // New rule seed weight based items
            "Onions,1.82,Gemüse",
            "Bacon,5.52,Eiweiß",
            "Apples,1.32,Frucht",
            "Grapes,2.98,Frucht",
            "Fish,9.99,Eiweiß",
            "Watermelons,0.32,Frucht",
            "Carrots,0.77,Gemüse",
            "Cherries,3.21,Frucht",
            "Plums,1.99,Frucht",
            "Pumpkins,1.38,Frucht",
            "Avocados,2.23,Frucht",
            "Ham,2.88,Eiweiß",
            "Sausages,3.88,Eiweiß",
            "Corn,1.14,Gemüse",
            "Pears,1.74,Frucht",
            "Leek,3.17,Gemüse",
            "Bologna,1.69,Eiweiß",
            "Minced Beef,2.36,Eiweiß",
            "Garlic,0.97,Gemüse",
            "Tofu,3.11,Eiweiß",
            "Salmon,21.55,Eiweiß",
        ];

        let SundayValue = 215;
        let MondayPercent = 85;
        let TuesdayExcludedDigit = -1;
        let WednesdayLargeOrSmall = true;
        let WednesdayViceVersa = true;
        let ThursdayOddItems = true;
        let ThursdayPercent = 50;
        let FridayPercent = 125;
        let SaturdayPercent = 65;

        function toDollars(intDollars) {
            const stringDollars = intDollars.toString();
            if (intDollars < 100) return "0." + intDollars;
            else return stringDollars.substring(0, stringDollars.length - 2) + "." + stringDollars.substring(stringDollars.length - 2);
        }

        function toRelativePercent(absolutePercent) {
            if (absolutePercent > 100) return `${absolutePercent - 100}% teurer`;
            else if (absolutePercent == 50) return "halb so teuer";
            else return `${100 - absolutePercent}% günstiger`;
        }

        function setDefaultRules(rng) {
            setRules(rng);
        }

        function setRules(rng) {
            var prices, pricesLB;
            if (rng.seed == 1)
            {
                prices = Prices.slice(0, 34);
                pricesLB = PricesLB.slice(0, 12);
            }
            else
            {
                prices = rng.shuffleFisherYates(Prices.slice(0)).slice(0, 34);
                pricesLB = rng.shuffleFisherYates(PricesLB.slice(0)).slice(0, 12);

                for (var [index, item] of prices.entries()) {
                    var split = item.split(",");
                    var intDollars = parseInt(split[1].replace(".", ""));
                    intDollars += rng.next(-10, 11);
                    split[1] = toDollars(intDollars);
                    prices[index] = split.join(",");
                }

                for (var [index, item] of pricesLB.entries()) {
                    var split = item.split(",");
                    var intDollars = parseInt(split[1].replace(".", ""));
                    intDollars += rng.next(-10, 11);
                    split[1] = toDollars(intDollars);
                    pricesLB[index] = split.join(",");
                }

                SundayValue = rng.next(50, 301);
                MondayPercent = rng.next(10, 100);
                TuesdayExcludedDigit = rng.next(-1, 3);
                WednesdayLargeOrSmall = rng.next(0, 2) == 1;
                WednesdayViceVersa = rng.next(0, 2) == 1;
                ThursdayOddItems = rng.next(0, 2) == 1;
                ThursdayPercent = rng.next(25, 76);
                FridayPercent = rng.next(50, 201);
                SaturdayPercent = rng.next(50, 201);
            }

            const seededStrings = [
                toDollars(SundayValue),
                toRelativePercent(MondayPercent),
                TuesdayExcludedDigit == -1 ? "" : `, mit Ausnahme der Ziffer an der ${["Einer", "Zehner", "Hunderter"][TuesdayExcludedDigit]}stelle`,
                WednesdayLargeOrSmall ? "größten" : "kleinsten",
                WednesdayLargeOrSmall ? "kleinste" : "größte",
                WednesdayViceVersa ? ", und umgekehrt" : "",
                ThursdayOddItems ? "ungerade" : "gerade",
                toRelativePercent(ThursdayPercent),
                toRelativePercent(FridayPercent),
                toRelativePercent(SaturdayPercent)
            ];

            const seededSpans = document.querySelectorAll("span.rule-seeded");
            for (const [index, seededSpan] of seededSpans.entries()) {
                seededSpan.textContent = seededStrings[index];
            }

            const rows = Array.from(document.querySelectorAll(".page-bg-02 tr:nth-child(n+2), .page-bg-03 tr"));
            for (const [index, itemString] of prices.concat(pricesLB).sort().entries()) {
                const children = rows[index % rows.length].children;
                const item = itemString.split(",");

                children[0].textContent = item[0];
                children[1].textContent = `$${item[1]}${pricesLB.includes(itemString) ? " pro lb" : "" }`;
                children[2].textContent = item[2];
            }
        }
    </script>
</head>
<body>
    <div class="section">
        <div class="page page-bg-01">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes-Modul</span>
                <span class="page-header-section-title">Klingelkasse</span>
            </div>
            <div class="page-content">
                <img class="diagram" src="img/Component/Cheap Checkout.svg">
                <h2>Betrifft: Klingelkasse</h2>
                <p class="flavour-text">Wer kauft denn bitte zu so einer Zeit etwas ein?</p>
                <ul>
                    <li>Eine Einkaufsliste zeigt Artikel, die gekauft werden und mit den Pfeiltasten ausgewählt werden können.</li>
                    <li>Darüber wird der vom Kunden bezahlte Betrag angezeigt.</li>
                    <li>Es gilt, die Preise aller Artikel aufzuaddieren. Dabei muss der für den aktuellen Wochentag geltende Rabatt auf jeden Artikel angewendet werden.</li>
                    <li>Ein evtl. Gewicht muss vor der Anwendung des Rabatts berechnet werden.</li>
                    <li>Wenn der Kunde genug bezahlt hat, muss einfach mithilfe der Tasten auf dem Modul der zutreffende Wechselgeldbetrag eingegeben und dann „Submit“ gedrückt werden.</li>
                    <li>Wenn der Kunde nicht genug bezahlt hat, muss „Submit“ ohne Wechselgeld gedrückt werden, um den Kunden zu benachrichtigen. Nach Anzeige des neuen Geldbetrags muss dann das richtige Wechselgeld berechnet werden.</li>
                    <li>Nach dem Drücken der „Submit“-Taste wird das Wechselgeld gelöscht.</li>
                </ul>
                <h3>Glossar</h3>
                <ul>
                    <li>Artikelpreis bezieht sich auf den Preis vor Anwendung des Rabatts.</li>
                    <li>Festpreisartikel haben Preise, die nicht von ihrem Gewicht abhängen.</li>
                    <li>Eine Quersumme wird berechnet, indem man die Ziffern addiert und dies mit der neuen Zahl solange wiederholt, bis man eine einstellige Zahl erhält.</li>
                    <li>Kaufmännisches Runden bedeutet, dass bei einer Ziffer von 5 oder größer aufgerundet wird, andernfalls wird abgerundet.</li>
                </ul>

                <h3>Rabatte:</h3>
                <div style="font-style: italic; font-size: 13px">Der Wochentag wird bei Aktivierung des Moduls über die Systemzeit beim Entschärfer bestimmt.</div>

                <em>Saftladen am Sonntag</em>
                <div class="sale">Alle Festpreisartikel, die ein S enthalten, sind $<span class="rule-seeded">2.15</span> teurer.</div>

                <em>Mumpitz am Montag</em>
                <div class="sale">Der 1., 3. und 6. Artikel auf der Einkaufsliste sind <span class="rule-seeded">15% günstiger</span>.</div>

                <em>Dynamik am Dienstag</em>
                <div class="sale">Unter Außerachtlassung des Dezimalkommas ist die Quersumme zu berechnen<span class="rule-seeded"></span>. So viele Dollar kommen zum Artikelpreis hinzu. Gilt nur für Festpreisartikel.</div>

                <em>Magie am Mittwoch</em>
                <div class="sale">Jedes Vorkommen der <span class="rule-seeded">größten</span> muss in die <span class="rule-seeded">kleinste</span> Ziffer im Preis geändert werden<span class="rule-seeded">, und umgekehrt</span>.</div>

                <em>Drastik am Donnerstag</em>
                <div class="sale">Alle <span class="rule-seeded">ungerade</span> positionierten Artikel auf der Einkaufsliste sind <span class="rule-seeded">halb so teuer</span>.</div>

                <em>Früchte am Freitag</em>
                <div class="sale">Alle Früchte sind <span class="rule-seeded">25% teurer</span> pro Pfund.</div>

                <em>Süßes am Samstag</em>
                <div class="sale">Alle Süßigkeiten sind <span class="rule-seeded">35% günstiger</span>.</div>
            </div>
            <div class="page-footer relative-footer">Seite 1 von 3</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes-Modul</span>
                <span class="page-header-section-title">Klingelkasse</span>
            </div>
            <div class="page-content">
                <h3>Artikelpreise:</h3>
                <div style="font-style: italic; font-size: 14px">Preise müssen immer in Dollar angegeben werden, zum Beispiel $0.68 und nicht 68¢. Preise werden auf die 2. Dezimalstelle gerundet. Eine kaufmännische Rundung wird sowohl nach Berechnung des Artikelpreises als auch nach Anwendung des Rabatts vorgenommen.</div>
                <div class="hstack">
                    <table>
                        <tr><th>Artikel</th><th>Preis</th><th>Kategorie</th></tr>
                        <tr><td>Bananas</td><td>$0.87 pro lb</td><td>Frucht</td></tr>
                        <tr><td>Broccoli</td><td>$1.39 pro lb</td><td>Gemüse</td></tr>
                        <tr><td>Candy Canes</td><td>$3.51</td><td>Süßigkeit</td></tr>
                        <tr><td>Canola Öl</td><td>$2.28</td><td>Öl</td></tr>
                        <tr><td>Cereal</td><td>$4.19</td><td>Getreide</td></tr>
                        <tr><td>Cheese</td><td>$4.49</td><td>Milchprodukt</td></tr>
                        <tr><td>Chicken</td><td>$1.99 pro lb</td><td>Eiweiß</td></tr>
                        <tr><td>Chocolate Bar</td><td>$2.10</td><td>Süßigkeit</td></tr>
                        <tr><td>Chocolate Milk</td><td>$5.68</td><td>Milchprodukt</td></tr>
                        <tr><td>Coffee Beans</td><td>$7.85</td><td>Sonstige</td></tr>
                        <tr><td>Cookies</td><td>$2.00</td><td>Süßigkeit</td></tr>
                        <tr><td>Deodorant</td><td>$3.97</td><td>Hygiene</td></tr>
                        <tr><td>Frucht Punch</td><td>$2.08</td><td>Süßigkeit</td></tr>
                        <tr><td>Grape Jelly</td><td>$2.98</td><td>Süßigkeit</td></tr>
                        <tr><td>Grapefruit</td><td>$1.08 pro lb</td><td>Frucht</td></tr>
                        <tr><td>Gum</td><td>$1.12</td><td>Süßigkeit</td></tr>
                        <tr><td>Honey</td><td>$8.25</td><td>Süßigkeit</td></tr>
                    </table>
                    <table>
                        <tr><th>Artikel</th><th>Preis</th><th>Kategorie</th></tr>
                        <tr><td>Mints</td><td>$6.39</td><td>Süßigkeit</td></tr>
                        <tr><td>Mustard</td><td>$2.36</td><td>Sonstige</td></tr>
                        <tr><td>Oranges</td><td>$0.80 pro lb</td><td>Frucht</td></tr>
                        <tr><td>Paper Towels</td><td>$9.46</td><td>Hygiene</td></tr>
                        <tr><td>Pasta Sauce</td><td>$2.30</td><td>Gemüse</td></tr>
                        <tr><td>Peanut Butter</td><td>$5.00</td><td>Eiweiß</td></tr>
                        <tr><td>Pork</td><td>$4.14 pro lb</td><td>Eiweiß</td></tr>
                        <tr><td>Potato Chips</td><td>$3.25</td><td>Öl</td></tr>
                        <tr><td>Potatoes</td><td>$0.68 pro lb</td><td>Gemüse</td></tr>
                        <tr><td>Shampoo</td><td>$4.98</td><td>Hygiene</td></tr>
                        <tr><td>Socks</td><td>$6.97</td><td>Sonstige</td></tr>
                        <tr><td>Soda</td><td>$2.05</td><td>Süßigkeit</td></tr>
                        <tr><td>Spaghetti</td><td>$2.92</td><td>Getreide</td></tr>
                        <tr><td>Steak</td><td>$4.97 pro lb</td><td>Eiweiß</td></tr>
                        <tr><td>Sugar</td><td>$2.08</td><td>Süßigkeit</td></tr>
                        <tr><td>Tea</td><td>$2.35</td><td>Wasser</td></tr>
                        <tr><td>Tissues</td><td>$3.94</td><td>Hygiene</td></tr>
                    </table>
                </div>
            </div>
            <div class="page-footer relative-footer">Seite 2 von 3</div>
        </div>
        <div class="page page-bg-03">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title">Klingelkasse</span>
            </div>
            <div class="page-content">
                <div class="hstack">
                    <table>
                        <tr><td>Ketchup</td><td>$3.59</td><td>Sonstige</td></tr>
                        <tr><td>Lemons</td><td>$1.74 pro lb</td><td>Frucht</td></tr>
                        <tr><td>Lettuce</td><td>$1.10 pro lb</td><td>Gemüse</td></tr>
                        <tr><td>Lollipops</td><td>$2.61</td><td>Süßigkeit</td></tr>
                        <tr><td>Lotion</td><td>$7.97</td><td>Hygiene</td></tr>
                        <tr><td>Mayonnaise</td><td>$3.99</td><td>Öl</td></tr>
                    </table>
                    <table>
                        <tr><td>Tomatoes</td><td>$1.80 pro lb</td><td>Frucht</td></tr>
                        <tr><td>Toothpaste</td><td>$2.50</td><td>Hygiene</td></tr>
                        <tr><td>Turkey</td><td>$2.98 pro lb</td><td>Eiweiß</td></tr>
                        <tr><td>Wasser Bottles</td><td>$9.37</td><td>Wasser</td></tr>
                        <tr><td>White Bread</td><td>$2.43</td><td>Getreide</td></tr>
                        <tr><td>White Milk</td><td>$3.62</td><td>Milchprodukt</td></tr>
                    </table>
                </div>
            </div>
            <div class="page-footer relative-footer">Seite 3 von 3</div>
        </div>
    </div>
</body>
</html>